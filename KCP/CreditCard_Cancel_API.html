<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://www.newebpay.com/images/head.ico" type="image/x-icon">
    <link rel="shortcut icon" href="https://www.newebpay.com/images/head.ico" type="image/x-icon">    
    <title data-i18n="page_title"></title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        html { scroll-behavior: smooth; }
        body { background-color: #f8fafc; }
        
        /* Custom Scrollbar */
        .scrollable-area::-webkit-scrollbar { width: 6px; }
        .scrollable-area::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 3px; }
        
        /* Navigation Active State */
        .sidebar-active { background-color: #e0f2fe; color: #0284c7; border-right: 4px solid #0284c7; font-weight: 600; }
        
        /* Tabs */
        .tab-btn { border-bottom: 2px solid transparent; transition: all 0.3s; }
        .tab-btn:hover { color: #60a5fa; }
        .tab-btn.active { border-bottom-color: #3b82f6; color: #3b82f6; font-weight: 600; background-color: rgba(59, 130, 246, 0.05); }
        
        /* Table Styles */
        .params-table th { background-color: #f1f5f9; color: #475569; font-weight: 700; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 0.05em; }
        .params-table td { vertical-align: top; color: #334155; }
        .params-table tr:hover { background-color: #f8fafc; }

        /* Tool styles */
        .tool-tab-btn { transition: all 0.2s; }
        .tool-tab-btn.active { border-bottom-color: #9333ea; color: #9333ea; background-color: #faf5ff; }
    </style>
</head>
<body class="text-slate-800 font-sans">

    <!-- Mobile Header -->
    <header class="lg:hidden bg-white shadow-sm p-4 sticky top-0 z-50 flex justify-between items-center border-b border-slate-200">
        <h1 class="text-lg font-bold text-blue-700 flex items-center">
            <i class="fas fa-credit-card mr-2"></i> <span data-i18n="header_mobile_title"></span>
        </h1>
        <button id="menu-btn" class="text-slate-600 focus:outline-none hover:text-blue-600 transition">
            <i class="fas fa-bars text-2xl"></i>
        </button>
    </header>

    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <aside id="sidebar" class="fixed inset-y-0 left-0 w-72 bg-white shadow-xl transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out z-40 border-r border-slate-200 flex flex-col">
            
            <!-- Top Section -->
            <div class="p-6 border-b border-slate-100 bg-gradient-to-r from-blue-50 to-white shrink-0">
                <h2 class="text-2xl font-bold text-blue-700 tracking-tight" data-i18n="sidebar_brand"></h2>
                <p class="text-sm text-slate-500 mt-1 font-medium"><span data-i18n="sidebar_subtitle"></span><br><span class="text-xs text-slate-400" data-i18n="sidebar_version_note"></span></p>
                
                <div class="mt-4">
                    <div class="text-xs bg-blue-100 text-blue-800 px-3 py-1 rounded-full inline-block font-mono font-semibold">Ver: 1.0</div>
                </div>
            </div>

            <!-- Scrollable Navigation Area -->
            <div class="flex-1 overflow-y-auto scrollable-area">
                <nav class="p-4 space-y-1">
                    <a href="#intro" class="nav-link block px-4 py-3 text-sm text-slate-600 hover:bg-slate-50 hover:text-blue-600 rounded-lg transition-colors group">
                        <i class="fas fa-info-circle w-6 group-hover:text-blue-500 transition-colors"></i> <span data-i18n="nav_intro"></span>
                    </a>
                    <a href="#setup" class="nav-link block px-4 py-3 text-sm text-slate-600 hover:bg-slate-50 hover:text-blue-600 rounded-lg transition-colors group">
                        <i class="fas fa-cogs w-6 group-hover:text-blue-500 transition-colors"></i> <span data-i18n="nav_setup"></span>
                    </a>
                    <a href="#tool" class="nav-link block px-4 py-3 text-sm text-purple-700 bg-purple-50 hover:bg-purple-100 hover:text-purple-800 rounded-lg transition-colors group border border-purple-100 mb-4 shadow-sm">
                        <i class="fas fa-wrench w-6 group-hover:text-purple-600 transition-colors"></i> <span data-i18n="nav_tool"></span>
                    </a>
                    <div class="px-4 py-2 text-xs font-bold text-slate-400 uppercase tracking-wider mt-4" data-i18n="nav_group_api"></div>
                    <a href="#request" class="nav-link block px-4 py-3 text-sm text-slate-600 hover:bg-slate-50 hover:text-blue-600 rounded-lg transition-colors group">
                        <i class="fas fa-paper-plane w-6 group-hover:text-blue-500 transition-colors"></i> <span data-i18n="nav_request"></span>
                    </a>
                    <a href="#encryption" class="nav-link block px-4 py-3 text-sm text-slate-600 hover:bg-slate-50 hover:text-blue-600 rounded-lg transition-colors group">
                        <i class="fas fa-lock w-6 group-hover:text-blue-500 transition-colors"></i> <span data-i18n="nav_encryption"></span>
                    </a>
                    <a href="#response" class="nav-link block px-4 py-3 text-sm text-slate-600 hover:bg-slate-50 hover:text-blue-600 rounded-lg transition-colors group">
                        <i class="fas fa-reply w-6 group-hover:text-blue-500 transition-colors"></i> <span data-i18n="nav_response"></span>
                    </a>
                    <a href="#errors" class="nav-link block px-4 py-3 text-sm text-slate-600 hover:bg-slate-50 hover:text-blue-600 rounded-lg transition-colors group">
                        <i class="fas fa-exclamation-triangle w-6 group-hover:text-blue-500 transition-colors"></i> <span data-i18n="nav_errors"></span>
                    </a>
                    <a href="#example" class="nav-link block px-4 py-3 text-sm text-slate-600 hover:bg-slate-50 hover:text-blue-600 rounded-lg transition-colors group">
                        <i class="fas fa-code w-6 group-hover:text-blue-500 transition-colors"></i> <span data-i18n="nav_example"></span>
                    </a>
                </nav>
            </div>

            <!-- Footer with Language Switcher -->
            <div class="p-4 border-t border-slate-200 bg-slate-50 shrink-0">
                <div class="relative group w-full">
                    <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-slate-400">
                        <i class="fas fa-globe"></i>
                    </div>
                    <select id="lang-select" onchange="changeLang(this.value)" class="w-full appearance-none bg-white hover:bg-white text-slate-600 font-medium py-2.5 pl-10 pr-8 rounded-lg text-sm transition-all focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer border border-slate-300 hover:border-blue-400 shadow-sm">
                        <!-- Options injected by JS -->
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-slate-500 group-hover:text-slate-700">
                        <i class="fas fa-chevron-up text-xs"></i>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 lg:ml-72 p-4 lg:p-8 w-[95%] mx-auto max-w-[1920px]">
            
            <!-- Intro -->
            <section id="intro" class="mb-12 scroll-mt-24">
                <div class="flex items-center mb-6">
                    <div class="w-2 h-8 bg-blue-600 mr-4 rounded-sm"></div>
                    <h1 class="text-3xl font-bold text-slate-900" data-i18n="intro_title"></h1>
                </div>
                
                <div class="bg-white p-6 lg:p-8 rounded-xl shadow-sm border border-slate-200">
                    <p class="text-slate-700 leading-relaxed mb-6 text-lg" data-i18n="intro_desc"></p>
                    
                    <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center">
                        <span class="bg-blue-100 text-blue-600 w-8 h-8 rounded-full flex items-center justify-center text-sm mr-2"><i class="fas fa-list-ul"></i></span> 
                        <span data-i18n="intro_funcs_title"></span>
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div class="bg-slate-50 p-4 rounded-lg border border-slate-200 flex items-start">
                            <i class="fas fa-undo-alt text-2xl text-green-600 mt-1 mr-4"></i>
                            <div>
                                <h4 class="font-bold text-slate-700" data-i18n="usecase_1_title"></h4>
                                <p class="text-sm text-slate-500 mt-1" data-i18n="usecase_1_desc"></p>
                            </div>
                        </div>
                        <div class="bg-slate-50 p-4 rounded-lg border border-slate-200 flex items-start">
                            <i class="fas fa-exclamation-circle text-2xl text-red-500 mt-1 mr-4"></i>
                            <div>
                                <h4 class="font-bold text-slate-700" data-i18n="usecase_2_title"></h4>
                                <p class="text-sm text-slate-500 mt-1" data-i18n="usecase_2_desc"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Setup -->
            <section id="setup" class="mb-12 scroll-mt-24">
                <div class="flex items-center mb-6">
                    <div class="w-2 h-8 bg-blue-600 mr-4 rounded-sm"></div>
                    <h2 class="text-2xl font-bold text-slate-900" data-i18n="setup_title"></h2>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div class="p-4 bg-slate-50 rounded-lg border border-slate-100">
                            <h3 class="font-bold text-slate-800 mb-2 flex items-center"><i class="fas fa-key text-blue-500 mr-2"></i> <span data-i18n="setup_card1_title"></span></h3>
                            <p class="text-sm text-slate-600" data-i18n="setup_card1_desc"></p>
                        </div>
                        <div class="p-4 bg-slate-50 rounded-lg border border-slate-100">
                            <h3 class="font-bold text-slate-800 mb-2 flex items-center"><i class="fas fa-network-wired text-blue-500 mr-2"></i> <span data-i18n="setup_card2_title"></span></h3>
                            <p class="text-sm text-slate-600" data-i18n="setup_card2_desc"></p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tool -->
             <section id="tool" class="mb-12 scroll-mt-24">
                <div class="flex items-center mb-6">
                    <div class="w-2 h-8 bg-purple-600 mr-4 rounded-sm"></div>
                    <h2 class="text-2xl font-bold text-slate-900" data-i18n="tool_title"></h2>
                </div>
                
                <div class="bg-white rounded-xl shadow-md border border-purple-100 overflow-hidden">
                    <div class="bg-purple-50 p-4 border-b border-purple-100">
                        <p class="text-purple-800 text-sm" data-i18n="tool_intro"></p>
                    </div>

                    <div class="flex border-b border-slate-200 overflow-x-auto">
                        <button onclick="switchToolTab('aes-encrypt')" class="tool-tab-btn active flex-1 py-4 px-4 text-sm font-bold text-center hover:bg-slate-50 transition border-b-2 border-purple-600 text-purple-600 whitespace-nowrap">
                            <i class="fas fa-lock mr-2"></i> <span data-i18n="tool_tab_encrypt"></span>
                        </button>
                        <button onclick="switchToolTab('aes-decrypt')" class="tool-tab-btn flex-1 py-4 px-4 text-sm font-bold text-center hover:bg-slate-50 transition border-b-2 border-transparent text-slate-500 whitespace-nowrap">
                            <i class="fas fa-unlock mr-2"></i> <span data-i18n="tool_tab_decrypt"></span>
                        </button>
                        <button onclick="switchToolTab('checkcode-calc')" class="tool-tab-btn flex-1 py-4 px-4 text-sm font-bold text-center hover:bg-slate-50 transition border-b-2 border-transparent text-slate-500 whitespace-nowrap">
                            <i class="fas fa-calculator mr-2"></i> <span data-i18n="tool_tab_checkcode"></span>
                        </button>
                    </div>

                    <div class="p-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 pb-6 border-b border-slate-100">
                            <div>
                                <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Hash Key (32 bytes)</label>
                                <input type="text" id="toolKey" data-i18n-placeholder="tool_ph_key" class="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-purple-500 font-mono text-sm bg-slate-50">
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Hash IV (16 bytes)</label>
                                <input type="text" id="toolIv" data-i18n-placeholder="tool_ph_iv" class="w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-purple-500 font-mono text-sm bg-slate-50">
                            </div>
                        </div>

                        <!-- Encrypt Tab -->
                        <div id="aes-encrypt" class="tool-content active">
                            <div class="mb-4">
                                <label class="block text-sm font-bold text-slate-700 mb-2" data-i18n="tool_lbl_qs"></label>
                                <textarea id="encryptInput" rows="5" data-i18n-placeholder="tool_ph_qs" class="w-full p-3 border border-slate-300 rounded focus:ring-2 focus:ring-purple-500 font-mono text-sm text-slate-600"></textarea>
                                <p class="text-xs text-slate-400 mt-1 text-right" data-i18n="tool_note_urlencode"></p>
                            </div>
                            <button onclick="runEncrypt()" class="bg-purple-600 text-white px-6 py-2 rounded hover:bg-purple-700 transition shadow-sm font-bold text-sm">
                                <i class="fas fa-arrow-down mr-1"></i> <span data-i18n="tool_btn_encrypt"></span>
                            </button>
                            <div class="mt-4">
                                <label class="block text-xs font-bold text-slate-500 uppercase mb-1" data-i18n="tool_lbl_hex"></label>
                                <div class="relative">
                                    <textarea id="encryptOutput" readonly rows="3" class="w-full p-3 bg-slate-800 text-green-400 rounded font-mono text-sm border-none focus:ring-0"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Decrypt Tab -->
                        <div id="aes-decrypt" class="tool-content hidden">
                             <div class="mb-4">
                                <label class="block text-sm font-bold text-slate-700 mb-2" data-i18n="tool_lbl_enc_hex"></label>
                                <textarea id="decryptInput" rows="4" data-i18n-placeholder="tool_ph_enc_hex" class="w-full p-3 border border-slate-300 rounded focus:ring-2 focus:ring-purple-500 font-mono text-sm text-slate-600"></textarea>
                            </div>
                            <button onclick="runDecrypt()" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition shadow-sm font-bold text-sm">
                                <i class="fas fa-arrow-down mr-1"></i> <span data-i18n="tool_btn_decrypt"></span>
                            </button>
                            <div class="mt-4">
                                <label class="block text-xs font-bold text-slate-500 uppercase mb-1" data-i18n="tool_lbl_decrypt_res"></label>
                                <div class="relative">
                                    <textarea id="decryptOutput" readonly rows="3" class="w-full p-3 bg-slate-800 text-green-400 rounded font-mono text-sm border-none focus:ring-0"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- CheckCode Tab -->
                        <div id="checkcode-calc" class="tool-content hidden">
                             <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1" data-i18n="tool_cc_mid">MerchantID</label>
                                    <input type="text" id="ccMid" class="w-full p-2 border border-slate-300 rounded font-mono text-sm">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1" data-i18n="tool_cc_amt">Amt</label>
                                    <input type="text" id="ccAmt" class="w-full p-2 border border-slate-300 rounded font-mono text-sm">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1" data-i18n="tool_cc_ord">MerchantOrderNo</label>
                                    <input type="text" id="ccOrd" class="w-full p-2 border border-slate-300 rounded font-mono text-sm">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1" data-i18n="tool_cc_trade">TradeNo</label>
                                    <input type="text" id="ccTrade" class="w-full p-2 border border-slate-300 rounded font-mono text-sm">
                                </div>
                             </div>
                             
                             <div class="bg-slate-50 p-3 rounded border border-slate-200 mb-4">
                                 <p class="text-xs text-slate-500 mb-1" data-i18n="tool_cc_formula_lbl"></p>
                                 <code id="ccFormulaPreview" class="block text-xs text-slate-400 break-all font-mono">HashIV=...&Amt=...&MerchantID=...&MerchantOrderNo=...&TradeNo=...&HashKey=...</code>
                             </div>

                            <button onclick="runCheckCode()" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 transition shadow-sm font-bold text-sm">
                                <i class="fas fa-check-circle mr-1"></i> <span data-i18n="tool_btn_cc"></span>
                            </button>
                            <div class="mt-4">
                                <label class="block text-xs font-bold text-slate-500 uppercase mb-1" data-i18n="tool_cc_res_label">CheckCode (SHA256)</label>
                                <div class="relative">
                                    <textarea id="ccOutput" readonly rows="2" class="w-full p-3 bg-slate-800 text-yellow-400 rounded font-mono text-sm border-none focus:ring-0"></textarea>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </section>

            <!-- Request -->
            <section id="request" class="mb-12 scroll-mt-24">
                <div class="flex items-center mb-6">
                    <div class="w-2 h-8 bg-blue-600 mr-4 rounded-sm"></div>
                    <h2 class="text-2xl font-bold text-slate-900" data-i18n="req_title"></h2>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 mb-8">
                    <h3 class="text-lg font-bold text-slate-800 mb-4 border-l-4 border-blue-500 pl-3" data-i18n="req_api_info"></h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                        <div class="bg-slate-50 p-3 rounded border border-slate-100">
                            <div class="text-xs text-slate-500 uppercase mb-1">Method</div>
                            <div class="font-mono font-bold text-green-600 text-lg">POST</div>
                        </div>
                        <div class="bg-slate-50 p-3 rounded border border-slate-100 md:col-span-2">
                            <div class="flex flex-col space-y-2">
                                <div>
                                    <div class="text-xs text-slate-500 uppercase mb-1" data-i18n="req_url_prod"></div>
                                    <div class="font-mono text-blue-600 select-all font-medium">https://core.newebpay.com/API/CreditCard/Cancel</div>
                                </div>
                                <div class="border-t border-slate-200 pt-2">
                                    <div class="text-xs text-slate-500 uppercase mb-1" data-i18n="req_url_test"></div>
                                    <div class="font-mono text-slate-500 select-all">https://ccore.newebpay.com/API/CreditCard/Cancel</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Level 1 Params -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden mb-8">
                    <div class="p-4 bg-slate-100 border-b border-slate-200">
                        <h3 class="font-bold text-slate-700" data-i18n="req_lvl1_title"></h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left text-sm params-table">
                            <thead class="bg-slate-50 border-b border-slate-200">
                                <tr>
                                    <th class="px-6 py-4 w-1/6" data-i18n="th_param"></th>
                                    <th class="px-6 py-4 w-1/6" data-i18n="th_name"></th>
                                    <th class="px-6 py-4 w-24 text-center" data-i18n="th_required"></th>
                                    <th class="px-6 py-4" data-i18n="th_type"></th>
                                    <th class="px-6 py-4 w-1/3" data-i18n="th_note"></th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-200">
                                <tr>
                                    <td class="px-6 py-4 font-mono font-bold text-blue-600">MerchantID_</td>
                                    <td class="px-6 py-4" data-i18n="param_mid_name"></td>
                                    <td class="px-6 py-4 text-center text-green-600"><i class="fas fa-check"></i></td>
                                    <td class="px-6 py-4 font-mono text-xs">String(10)</td>
                                    <td class="px-6 py-4" data-i18n="param_mid_note"></td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 font-mono font-bold text-blue-600">PostData_</td>
                                    <td class="px-6 py-4" data-i18n="param_post_name"></td>
                                    <td class="px-6 py-4 text-center text-green-600"><i class="fas fa-check"></i></td>
                                    <td class="px-6 py-4 font-mono text-xs">Text</td>
                                    <td class="px-6 py-4" data-i18n="param_post_note"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Level 2 Params -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="p-4 bg-slate-100 border-b border-slate-200 flex justify-between items-center">
                        <h3 class="font-bold text-slate-700" data-i18n="req_lvl2_title"></h3>
                        <span class="text-xs text-slate-500 bg-white px-2 py-1 rounded border">AES-256-CBC Encrypted</span>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left text-sm params-table">
                            <thead class="bg-slate-50 border-b border-slate-200">
                                <tr>
                                    <th class="px-6 py-4 w-32" data-i18n="th_param"></th>
                                    <th class="px-6 py-4 w-32" data-i18n="th_name"></th>
                                    <th class="px-6 py-4 w-16 text-center" data-i18n="th_required"></th>
                                    <th class="px-6 py-4 w-24" data-i18n="th_type"></th>
                                    <th class="px-6 py-4" data-i18n="th_note"></th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-200">
                                <tr>
                                    <td class="px-6 py-3 font-mono font-medium">RespondType</td>
                                    <td class="px-6 py-3" data-i18n="p_res_name"></td>
                                    <td class="px-6 py-3 text-center text-green-600"><i class="fas fa-check"></i></td>
                                    <td class="px-6 py-3 font-mono text-xs">String(5)</td>
                                    <td class="px-6 py-3" data-i18n="p_res_note"></td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-3 font-mono font-medium">Version</td>
                                    <td class="px-6 py-3" data-i18n="p_ver_name"></td>
                                    <td class="px-6 py-3 text-center text-green-600"><i class="fas fa-check"></i></td>
                                    <td class="px-6 py-3 font-mono text-xs">String(5)</td>
                                    <td class="px-6 py-3" data-i18n="p_ver_note"></td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-3 font-mono font-medium">Amt</td>
                                    <td class="px-6 py-3" data-i18n="p_amt_name"></td>
                                    <td class="px-6 py-3 text-center text-green-600"><i class="fas fa-check"></i></td>
                                    <td class="px-6 py-3 font-mono text-xs">Int(10)</td>
                                    <td class="px-6 py-3" data-i18n="p_amt_note"></td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-3 font-mono font-medium">IndexType</td>
                                    <td class="px-6 py-3" data-i18n="p_idx_name"></td>
                                    <td class="px-6 py-3 text-center text-green-600"><i class="fas fa-check"></i></td>
                                    <td class="px-6 py-3 font-mono text-xs">Int(1)</td>
                                    <td class="px-6 py-3" data-i18n="p_idx_note"></td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-3 font-mono font-medium">MerchantOrderNo</td>
                                    <td class="px-6 py-3" data-i18n="p_ord_name"></td>
                                    <td class="px-6 py-3 text-center text-slate-400">*</td>
                                    <td class="px-6 py-3 font-mono text-xs">String(30)</td>
                                    <td class="px-6 py-3" data-i18n="p_ord_note"></td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-3 font-mono font-medium">TradeNo</td>
                                    <td class="px-6 py-3" data-i18n="p_trade_name"></td>
                                    <td class="px-6 py-3 text-center text-slate-400">*</td>
                                    <td class="px-6 py-3 font-mono text-xs">String(17)</td>
                                    <td class="px-6 py-3" data-i18n="p_trade_note"></td>
                                </tr>
                                <!-- Added ProcessNo here -->
                                <tr>
                                    <td class="px-6 py-3 font-mono font-medium">ProcessNo</td>
                                    <td class="px-6 py-3" data-i18n="p_process_name"></td>
                                    <td class="px-6 py-3 text-center text-slate-400"></td>
                                    <td class="px-6 py-3 font-mono text-xs">String(30)</td>
                                    <td class="px-6 py-3" data-i18n="p_process_note"></td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-3 font-mono font-medium">TimeStamp</td>
                                    <td class="px-6 py-3" data-i18n="p_ts_name"></td>
                                    <td class="px-6 py-3 text-center text-green-600"><i class="fas fa-check"></i></td>
                                    <td class="px-6 py-3 font-mono text-xs">String(30)</td>
                                    <td class="px-6 py-3" data-i18n="p_ts_note"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Encryption Rules Section -->
            <section id="encryption" class="mb-12 scroll-mt-24">
                <div class="flex items-center mb-6">
                    <div class="w-2 h-8 bg-blue-600 mr-4 rounded-sm"></div>
                    <h2 class="text-2xl font-bold text-slate-900" data-i18n="enc_title"></h2>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 mb-8">
                    <!-- Request Encryption -->
                    <h3 class="text-lg font-bold text-slate-800 mb-4 flex items-center">
                        <span class="w-6 h-6 bg-blue-100 text-blue-600 rounded flex items-center justify-center text-xs mr-2"><i class="fas fa-lock"></i></span>
                        <span data-i18n="enc_aes_title"></span>
                    </h3>
                    <p class="text-slate-600 mb-4" data-i18n="enc_aes_desc"></p>
                    
                    <div class="bg-slate-50 p-4 rounded-lg border border-slate-200 space-y-4 mb-8">
                        <div class="flex">
                            <div class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">1</div>
                            <div class="ml-4">
                                <h4 class="font-bold text-slate-800" data-i18n="enc_step1_title"></h4>
                                <p class="text-sm text-slate-600 mt-1" data-i18n="enc_step1_desc"></p>
                                <code class="block bg-slate-800 text-slate-300 p-2 rounded mt-2 text-xs font-mono">RespondType=JSON&Version=1.0&Amt=30&IndexType=1&MerchantOrderNo=ORD123...</code>
                            </div>
                        </div>
                        <div class="flex">
                            <div class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">2</div>
                            <div class="ml-4">
                                <h4 class="font-bold text-slate-800" data-i18n="enc_step2_title"></h4>
                                <p class="text-sm text-slate-600 mt-1" data-i18n="enc_step2_desc"></p>
                            </div>
                        </div>
                        <div class="flex">
                            <div class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">3</div>
                            <div class="ml-4">
                                <h4 class="font-bold text-slate-800" data-i18n="enc_step3_title"></h4>
                                <p class="text-sm text-slate-600 mt-1" data-i18n="enc_step3_desc"></p>
                            </div>
                        </div>
                    </div>

                    <!-- CheckCode Rule -->
                     <h3 class="text-lg font-bold text-slate-800 mb-4 flex items-center border-t border-slate-200 pt-6">
                        <span class="w-6 h-6 bg-green-100 text-green-600 rounded flex items-center justify-center text-xs mr-2"><i class="fas fa-check-double"></i></span>
                        <span data-i18n="enc_cc_title"></span>
                    </h3>
                    <p class="text-slate-600 mb-4" data-i18n="enc_cc_desc"></p>
                    <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                        <h4 class="font-bold text-green-900 text-sm mb-2" data-i18n="enc_cc_step1_title"></h4>
                        <p class="text-sm text-green-800 mb-2" data-i18n="enc_cc_step1_desc"></p>
                        <code class="block bg-white border border-green-200 text-green-700 p-3 rounded font-mono text-sm mb-4">
                            HashIV={HashIV}&Amt={Amt}&MerchantID={MerchantID}&MerchantOrderNo={MerchantOrderNo}&TradeNo={TradeNo}&HashKey={HashKey}
                        </code>
                         <h4 class="font-bold text-green-900 text-sm mb-2" data-i18n="enc_cc_step2_title"></h4>
                        <p class="text-sm text-green-800" data-i18n="enc_cc_step2_desc">
                        </p>
                    </div>

                </div>
            </section>

            <!-- Response -->
            <section id="response" class="mb-12 scroll-mt-24">
                <div class="flex items-center mb-6">
                    <div class="w-2 h-8 bg-blue-600 mr-4 rounded-sm"></div>
                    <h2 class="text-2xl font-bold text-slate-900" data-i18n="res_title"></h2>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 mb-6">
                    <p class="text-slate-600 mb-4" data-i18n="res_desc"></p>
                    <table class="w-full text-left text-sm mb-6 border border-slate-200">
                        <thead class="bg-slate-50">
                            <tr>
                                <th class="px-4 py-2 border-b" data-i18n="th_param"></th>
                                <th class="px-4 py-2 border-b" data-i18n="th_name"></th>
                                <th class="px-4 py-2 border-b" data-i18n="th_type"></th>
                                <th class="px-4 py-2 border-b" data-i18n="th_note"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="px-4 py-2 border-b font-mono font-bold text-blue-600">Status</td>
                                <td class="px-4 py-2 border-b" data-i18n="res_status_name"></td>
                                <td class="px-4 py-2 border-b font-mono text-xs">String(10)</td>
                                <td class="px-4 py-2 border-b" data-i18n="res_status_note"></td>
                            </tr>
                            <tr>
                                <td class="px-4 py-2 border-b font-mono font-bold text-blue-600">Message</td>
                                <td class="px-4 py-2 border-b" data-i18n="res_msg_name"></td>
                                <td class="px-4 py-2 border-b font-mono text-xs">String(30)</td>
                                <td class="px-4 py-2 border-b" data-i18n="res_msg_note"></td>
                            </tr>
                            <tr>
                                <td class="px-4 py-2 border-b font-mono font-bold text-blue-600">Result</td>
                                <td class="px-4 py-2 border-b" data-i18n="res_result_name"></td>
                                <td class="px-4 py-2 border-b font-mono text-xs">Array</td>
                                <td class="px-4 py-2 border-b" data-i18n="res_result_note"></td>
                            </tr>
                        </tbody>
                    </table>

                     <!-- Result Details -->
                    <div class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                        <h4 class="font-bold text-slate-700 mb-3" data-i18n="res_detail_title"></h4>
                        <table class="w-full text-left text-sm params-table bg-white rounded shadow-sm overflow-hidden">
                             <thead class="bg-slate-100 border-b border-slate-200">
                                <tr>
                                    <th class="px-4 py-2 w-1/4" data-i18n="th_param"></th>
                                    <th class="px-4 py-2" data-i18n="th_name"></th>
                                    <th class="px-4 py-2" data-i18n="th_type"></th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100">
                                <tr>
                                    <td class="px-4 py-2 font-mono">MerchantID</td>
                                    <td class="px-4 py-2" data-i18n="res_detail_mid"></td>
                                    <td class="px-4 py-2 font-mono text-xs">String(15)</td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-2 font-mono">TradeNo</td>
                                    <td class="px-4 py-2" data-i18n="res_detail_trade"></td>
                                    <td class="px-4 py-2 font-mono text-xs">String(20)</td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-2 font-mono">Amt</td>
                                    <td class="px-4 py-2" data-i18n="res_detail_amt"></td>
                                    <td class="px-4 py-2 font-mono text-xs">Int(15)</td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-2 font-mono">MerchantOrderNo</td>
                                    <td class="px-4 py-2" data-i18n="res_detail_ord"></td>
                                    <td class="px-4 py-2 font-mono text-xs">String(30)</td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-2 font-mono text-green-600 font-bold">CheckCode</td>
                                    <td class="px-4 py-2" data-i18n="res_detail_cc"></td>
                                    <td class="px-4 py-2 font-mono text-xs">Hash</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

             <!-- Errors -->
             <section id="errors" class="mb-12 scroll-mt-24">
                <div class="flex items-center mb-6">
                    <div class="w-2 h-8 bg-blue-600 mr-4 rounded-sm"></div>
                    <h2 class="text-2xl font-bold text-slate-900" data-i18n="err_title"></h2>
                </div>
                
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 mb-4">
                    <div class="relative">
                        <i class="fas fa-search absolute left-4 top-3.5 text-slate-400"></i>
                        <input type="text" id="errorSearch" data-i18n-placeholder="err_search_ph" class="w-full pl-10 p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
                    </div>
                </div>
                <div class="overflow-x-auto bg-white rounded-xl shadow-sm border border-slate-200 max-h-[600px] overflow-y-auto">
                    <table class="w-full text-left text-sm" id="errorTable">
                        <thead class="bg-slate-50 text-slate-600 uppercase font-bold sticky top-0 border-b border-slate-200 shadow-sm">
                            <tr>
                                <th class="px-6 py-4 w-1/4" data-i18n="th_err_code"></th>
                                <th class="px-6 py-4" data-i18n="th_err_reason"></th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-200 font-mono text-slate-700">
                             <!-- Dynamic Generation -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Example -->
            <section id="example" class="mb-12 scroll-mt-24">
                <div class="flex items-center mb-6">
                    <div class="w-2 h-8 bg-blue-600 mr-4 rounded-sm"></div>
                    <h2 class="text-2xl font-bold text-slate-900" data-i18n="example_title"></h2>
                </div>
                
                <div class="bg-slate-800 rounded-lg shadow-lg overflow-hidden relative">
                    <div class="flex border-b border-slate-600 bg-slate-900 px-2">
                        <button onclick="switchTab('php', event)" class="tab-btn active px-6 py-3 text-sm font-medium text-slate-300 hover:text-white transition-colors">PHP</button>
                        <button onclick="switchTab('nodejs', event)" class="tab-btn px-6 py-3 text-sm font-medium text-slate-300 hover:text-white transition-colors">Node.js</button>
                        <button onclick="switchTab('python', event)" class="tab-btn px-6 py-3 text-sm font-medium text-slate-300 hover:text-white transition-colors">Python</button>
                        <button onclick="switchTab('csharp', event)" class="tab-btn px-6 py-3 text-sm font-medium text-slate-300 hover:text-white transition-colors">C# (.NET)</button>
                    </div>

                    <textarea id="code-display" readonly class="w-full h-[600px] p-4 bg-[#272822] text-[#f8f8f2] font-mono text-sm leading-6 border-none outline-none resize-none"></textarea>
                </div>
            </section>

        </main>
    </div>

    <script>
        // Multi-language configuration
        const langData = {
            'zh-TW': {name: '繁體中文',data: {    page_title: '藍新金流 - 信用卡取消授權 API 文件',    header_mobile_title: '信用卡取消授權 API',    sidebar_brand: 'NewebPay',    sidebar_subtitle: '信用卡取消授權 API',    sidebar_version_note: '(CreditCard/Cancel)',    nav_intro: '簡介與功能',    nav_setup: '串接前置準備',    nav_tool: '加密測試工具',    nav_group_api: 'API 規格',    nav_request: '請求參數 (Request)',    nav_encryption: '加密規則詳解',    nav_response: '回應參數 (Response)',    nav_errors: '錯誤代碼表',    nav_example: '範例程式碼',    intro_title: '簡介與功能',    intro_desc: '此 API 允許商店針對「已授權成功」但「尚未請款」的信用卡交易進行取消（放棄授權）。一旦取消成功，該筆交易將不會向持卡人請款。',    intro_funcs_title: '應用場景',    usecase_1_title: '訂單取消',    usecase_1_desc: '當消費者在下單後立即取消訂單，且該筆交易尚未請款時，可使用此 API 釋放信用卡額度。',    usecase_2_title: '交易異常處理',    usecase_2_desc: '若系統偵測到訂單邏輯異常（如庫存不足但已授權），可立即呼叫此 API 取消該筆授權。',    setup_title: '串接前置準備',    setup_card1_title: '取得金鑰',    setup_card1_desc: '須於藍新金流會員專區取得商店代號 (MerchantID) 以及對應的 <code>Hash Key</code> 與 <code>Hash IV</code>。',    setup_card2_title: '確認網址',    setup_card2_desc: '測試環境：https://ccore.newebpay.com/API/CreditCard/Cancel<br>正式環境：https://core.newebpay.com/API/CreditCard/Cancel',    tool_title: '加密測試工具',    tool_intro: '此工具可協助您產生 PostData_ 加密字串，或驗證回傳的 CheckCode。',    tool_tab_encrypt: 'AES 加密 (Request)',    tool_tab_decrypt: 'AES 解密 (Response)',    tool_tab_checkcode: 'CheckCode 計算 (Response)',    tool_ph_key: '例如: AAAAvw3YlqoEk6G4HqRKDAYpHKZWxBBB',    tool_ph_iv: '例如: AAAACC1FplieBBBB',    tool_lbl_qs: '原始請求字串 (Query String)',    tool_ph_qs: '例如: RespondType=JSON&Version=1.0&Amt=30&MerchantOrderNo=ORD_123456&IndexType=1&TimeStamp=1700000000',    tool_note_urlencode: '請確認字串已經過 http_build_query 或 urlencode 處理',    tool_btn_encrypt: '執行加密產生 PostData_',    tool_lbl_hex: '加密結果 (Hex String)',    tool_lbl_enc_hex: '加密字串 (Hex String)',    tool_ph_enc_hex: '例如: 0ef82edabaf8964d09992d7ec8e575f1...',    tool_btn_decrypt: '執行解密',    tool_lbl_decrypt_res: '解密結果 (原始資料)',    tool_btn_cc: '計算 CheckCode',    tool_cc_formula_lbl: '計算公式預覽 (SHA256)',    tool_cc_mid: 'MerchantID',    tool_cc_amt: 'Amt',    tool_cc_ord: 'MerchantOrderNo',    tool_cc_trade: 'TradeNo',    tool_cc_res_label: 'CheckCode (SHA256)',    req_title: '請求參數 (Request)',    req_api_info: 'API 資訊',    req_url_prod: 'URL (正式環境)',    req_url_test: 'URL (測試環境)',    req_lvl1_title: '第一層參數 (HTML Form Post)',    th_param: '參數名稱',    th_name: '中文名稱',    th_required: '必填',    th_type: '型態',    th_note: '備註',    param_mid_name: '商店代號',    param_mid_note: '藍新金流商店代號。',    param_post_name: '加密資料',    param_post_note: '將參數串接後，使用 AES-256-CBC 加密並轉為 Hex 字串。',    req_lvl2_title: 'PostData_ 內含參數 (加密前)',    p_res_name: '回傳格式',    p_res_note: '固定填入 <code class="bg-slate-100 px-1">JSON</code> 或 <code class="bg-slate-100 px-1">String</code>。',    p_ver_name: '串接版本',    p_ver_note: '固定填入 <code class="bg-slate-100 px-1">1.0</code>。',    p_amt_name: '取消金額',    p_amt_note: '純數字不含符號，需與原授權金額相同。',    p_idx_name: '單號類別',    p_idx_note: '1: 使用商店訂單編號 (MerchantOrderNo)<br>2: 使用藍新交易序號 (TradeNo)',    p_ord_name: '商店訂單編號',    p_ord_note: 'IndexType=1 時必填。<br>與藍新金流交易序號二擇一填入。',    p_trade_name: '藍新交易序號',    p_trade_note: 'IndexType=2 時必填。<br>與商店訂單編號二擇一填入。',    p_process_name: '商店自訂作業編號',    p_process_note: '商店可為此次作業自訂一個作業編號。',    p_ts_name: '時間戳記',    p_ts_note: 'Unix 時間戳記 (秒)。<br>PHP範例：<code>time()</code> 回傳值。<br>容許誤差 120 秒。',    enc_title: '加密規則詳解',    enc_aes_title: 'AES 加解密機制 (PostData_)',    enc_aes_desc: '為防止重要交易訊息洩漏，需於加密前使用商店之 Hash Key 及 Hash IV 對參數字串執行 AES 加密。',    enc_step1_title: '生成請求字串',    enc_step1_desc: '將所有參數依照 <code>http_build_query</code> 格式組合 (key=value&key2=value2...)。',    enc_step2_title: 'AES 加密',    enc_step2_desc: '加密演算法：<span class="font-bold text-red-600">AES-256-CBC</span><br>填充模式 (Padding)：<span class="font-bold text-red-600">PKCS7</span><br>Key / IV：請使用商店專屬的 Hash Key 與 Hash IV。',    enc_step3_title: '轉十六進制 (Hex)',    enc_step3_desc: '將加密後的二進位資料 (Raw Data) 轉換為 Hex String (小寫)，即為 <code>PostData_</code>。',    enc_cc_title: 'CheckCode 檢核碼產生規則 (回應驗證)',    enc_cc_desc: '為確保回傳資料未經竄改，藍新金流會回傳 CheckCode。商店端可依照相同規則自行計算並比對。',    enc_cc_step1_title: 'Step 1: 參數串接',    enc_cc_step1_desc: '請依照以下順序將參數與 HashKey、HashIV 串接：',    enc_cc_step2_title: 'Step 2: SHA256 加密與轉大寫',    enc_cc_step2_desc: '將串接後的字串進行 SHA256 加密，並將結果轉換為<strong>大寫</strong>。',    res_title: '回應參數 (Response)',    res_desc: 'API 回傳 JSON 格式資料。',    res_status_name: '回傳狀態',    res_status_note: 'SUCCESS: 取消授權成功。<br>TRA20001: 需由金融機構批次處理。',    res_msg_name: '回傳訊息',    res_msg_note: '文字，敘述此次交易狀態 (如：放棄授權成功)。',    res_result_name: '回傳資料',    res_result_note: '陣列，包含 MerchantID, TradeNo, Amt, CheckCode 等詳細資訊。',    res_detail_title: 'Result 物件內含參數',    res_detail_mid: '商店代號',    res_detail_trade: '藍新金流交易序號',    res_detail_amt: '交易金額',    res_detail_ord: '商店訂單編號',    res_detail_cc: '檢核碼 (參見加密規則)',    err_title: '錯誤代碼表',    err_search_ph: '搜尋代碼...',    th_err_code: '錯誤代碼',    th_err_reason: '錯誤原因 / 備註',    example_title: '範例程式碼',    err_MPG01002: '時間戳記不可空白',    err_MPG01005: 'TokenTerm不可空白/設定錯誤',    err_MPG01009: '商店代號不可空白',    err_MPG01011: '回傳規格設定錯誤',    err_MPG01012: '商店訂單編號不可空白/設定錯誤 (限英數字、底線，長度30字)',    err_MPG01023: '交易加密資料不可空白',    err_MPG01024: '交易加密SHA資料不可空白',    err_MPG01028: '訂單細項格式錯誤',    err_MPG02002: '查無商店開啟任何金流服務',    err_MPG02005: '驗證資料錯誤(來源不合法)',    err_MPG03001: 'FormPost加密失敗',    err_MPG03002: '拒絕交易 IP',    err_MPG03003: 'IP 交易次數限制 (N 分鐘內不可交易達 M 次)',    err_MPG03004: '商店狀態已被暫停或是關閉，無法進行交易',    err_MPG03005: '回傳參數資料不存在/解密失敗',    err_MPG03006: '回傳參數資料不存在/解密失敗',    err_MEM40008: '必填欄位資料不可空白',    err_MEM40012: '必填欄位資料傳遞錯誤 (PostData_空白)',    err_MEM40013: '必填欄位資料不齊全',    err_MEM40014: '傳送時間錯誤',    err_NOR1001: '連線異常',    err_TRA10001: '商店資料取得失敗',    err_TRA10003: '金額必須為數字',    err_TRA10008: '資料加密錯誤 (PostData_解密失敗)',    err_TRA10009: '商店代號不可空白',    err_TRA10012: '商店代號停用',    err_TRA10015: '網路連線失敗',    err_TRA10018: '資料不足',    err_TRA10021: '查無該筆交易或該筆交易不為信用卡交易',    err_TRA10047: '該交易不為授權成功狀態，不可放棄授權 (可能已請款或已失敗)',    err_TRA10048: '該交易正在請款狀態',    err_TRA10049: '該交易正在退款狀態',    err_TRA10050: '金額不符 (需與授權金額相同)',    err_TRA10051: '取消授權失敗',    err_TRA10094: '資料取消失敗',    err_TRA10095: '此筆交易已過關帳時間，不可取消',    err_TRA20001: '金融機構取消授權批次處理中',    err_TRA20002: '查無交易資料',    err_TRA40014: 'TimeStamp欄位錯誤',    err_1102: '查無商店',    err_1103: '查無訂單資料',    err_2100: '最低金額為1',    err_4101: 'EncryptData_ 不可為空白',    err_4102: 'HashData_ 不可為空白',    err_4103: 'HashData_ 資料檢查不符合',    err_4104: '加密資料有誤 (請確認Hash_Key與Hash_IV是否正確)',    err_4105: 'TimeStamp 為空',    err_9000: '網路連線失敗'}            },
            'EN': {name: 'English',data: {  page_title: 'NewebPay - Credit Card Cancel Auth API Documentation',  header_mobile_title: 'Credit Card Cancel Auth API',  sidebar_brand: 'NewebPay',  sidebar_subtitle: 'Credit Card Cancel Auth API',  sidebar_version_note: '(CreditCard/Cancel)',  nav_intro: 'Introduction',  nav_setup: 'Prerequisites',  nav_tool: 'Encryption Tool',  nav_group_api: 'API Specs',  nav_request: 'Request Parameters',  nav_encryption: 'Encryption Rules',  nav_response: 'Response Parameters',  nav_errors: 'Error Codes',  nav_example: 'Code Example',  intro_title: 'Introduction & Features',  intro_desc: 'This API allows merchants to cancel (void) credit card transactions that are "Authorized" but "Not Yet Captured". Once successfully cancelled, the cardholder will not be charged.',  intro_funcs_title: 'Use Cases',  usecase_1_title: 'Order Cancellation',  usecase_1_desc: 'Release credit limit immediately via this API when a consumer cancels an order right after placement, provided the transaction has not been captured.',  usecase_2_title: 'Exception Handling',  usecase_2_desc: 'If the system detects an order anomaly (e.g., insufficient stock but authorized), call this API immediately to void the authorization.',  setup_title: 'Prerequisites',  setup_card1_title: 'Obtain Keys',  setup_card1_desc: 'Obtain the MerchantID, <code>Hash Key</code>, and <code>Hash IV</code> from the NewebPay Member Area.',  setup_card2_title: 'Confirm URLs',  setup_card2_desc: 'Test Env: https://ccore.newebpay.com/API/CreditCard/Cancel<br>Prod Env: https://core.newebpay.com/API/CreditCard/Cancel',  tool_title: 'Encryption Testing Tool',  tool_intro: 'This tool assists in generating the PostData_ encrypted string or verifying the returned CheckCode.',  tool_tab_encrypt: 'AES Encrypt (Request)',  tool_tab_decrypt: 'AES Decrypt (Response)',  tool_tab_checkcode: 'CheckCode Calculation (Response)',  tool_ph_key: 'Ex: AAAAvw3YlqoEk6G4HqRKDAYpHKZWxBBB',  tool_ph_iv: 'Ex: AAAACC1FplieBBBB',  tool_lbl_qs: 'Original Query String',  tool_ph_qs: 'Ex: RespondType=JSON&Version=1.0&Amt=30&MerchantOrderNo=ORD_123456&IndexType=1&TimeStamp=1700000000',  tool_note_urlencode: 'Please ensure the string is processed via http_build_query or urlencode.',  tool_btn_encrypt: 'Encrypt to Generate PostData_',  tool_lbl_hex: 'Encryption Result (Hex String)',  tool_lbl_enc_hex: 'Encrypted String (Hex String)',  tool_ph_enc_hex: 'Ex: 0ef82edabaf8964d09992d7ec8e575f1...',  tool_btn_decrypt: 'Decrypt',  tool_lbl_decrypt_res: 'Decryption Result (Raw Data)',  tool_btn_cc: 'Calculate CheckCode',  tool_cc_formula_lbl: 'Formula Preview (SHA256)',  tool_cc_mid: 'MerchantID',  tool_cc_amt: 'Amt',  tool_cc_ord: 'MerchantOrderNo',  tool_cc_trade: 'TradeNo',  tool_cc_res_label: 'CheckCode (SHA256)',  req_title: 'Request Parameters',  req_api_info: 'API Information',  req_url_prod: 'URL (Production)',  req_url_test: 'URL (Test)',  req_lvl1_title: 'Level 1 Parameters (HTML Form Post)',  th_param: 'Parameter',  th_name: 'Name',  th_required: 'Required',  th_type: 'Type',  th_note: 'Note',  param_mid_name: 'Merchant ID',  param_mid_note: 'NewebPay Merchant ID.',  param_post_name: 'Encrypted Data',  param_post_note: 'Concatenate parameters, encrypt using AES-256-CBC, and convert to Hex string.',  req_lvl2_title: 'Parameters inside PostData_ (Pre-encryption)',  p_res_name: 'Response Format',  p_res_note: 'Fixed value: <code class="bg-slate-100 px-1">JSON</code> or <code class="bg-slate-100 px-1">String</code>.',  p_ver_name: 'Version',  p_ver_note: 'Fixed value: <code class="bg-slate-100 px-1">1.0</code>.',  p_amt_name: 'Cancel Amount',  p_amt_note: 'Numbers only, no symbols. Must match original authorization amount.',  p_idx_name: 'Index Type',  p_idx_note: '1: Use Merchant Order No (MerchantOrderNo)<br>2: Use NewebPay Trade No (TradeNo)',  p_ord_name: 'Merchant Order No',  p_ord_note: 'Required if IndexType=1.<br>Alternative to TradeNo.',  p_trade_name: 'NewebPay Trade No',  p_trade_note: 'Required if IndexType=2.<br>Alternative to MerchantOrderNo.',  p_process_name: 'Custom Process ID',  p_process_note: 'Merchant defined ID for this operation.',  p_ts_name: 'Timestamp',  p_ts_note: 'Unix Timestamp (seconds).<br>PHP Example: <code>time()</code> return value.<br>Tolerance: 120 seconds.',  enc_title: 'Encryption Details',  enc_aes_title: 'AES Encryption (PostData_)',  enc_aes_desc: 'To prevent leakage of sensitive data, parameters must be AES encrypted using the Merchant Hash Key and Hash IV.',  enc_step1_title: 'Generate Query String',  enc_step1_desc: 'Combine all parameters following <code>http_build_query</code> format (key=value&key2=value2...).',  enc_step2_title: 'AES Encryption',  enc_step2_desc: 'Algorithm: <span class="font-bold text-red-600">AES-256-CBC</span><br>Padding: <span class="font-bold text-red-600">PKCS7</span><br>Key / IV: Use your specific Hash Key and Hash IV.',  enc_step3_title: 'Convert to Hex',  enc_step3_desc: 'Convert the encrypted binary data (Raw Data) to a Hex String (lowercase). This is your <code>PostData_</code>.',  enc_cc_title: 'CheckCode Generation Rule (Response Validation)',  enc_cc_desc: 'NewebPay returns a CheckCode to ensure data integrity. Merchants can verify it by calculating it locally using the same rule.',  enc_cc_step1_title: 'Step 1: Concatenate Parameters',  enc_cc_step1_desc: 'Concatenate parameters with HashKey and HashIV in the following order:',  enc_cc_step2_title: 'Step 2: SHA256 & Uppercase',  enc_cc_step2_desc: 'Encrypt the string using SHA256 and convert the result to <strong>uppercase</strong>.',  res_title: 'Response Parameters',  res_desc: 'API returns data in JSON format.',  res_status_name: 'Status',  res_status_note: 'SUCCESS: Authorization cancelled.<br>TRA20001: Batch processing by financial institution required.',  res_msg_name: 'Message',  res_msg_note: 'Text description of the transaction status (e.g., Void Successful).',  res_result_name: 'Result Data',  res_result_note: 'Array containing MerchantID, TradeNo, Amt, CheckCode, etc.',  res_detail_title: 'Parameters inside Result Object',  res_detail_mid: 'Merchant ID',  res_detail_trade: 'NewebPay Trade No',  res_detail_amt: 'Transaction Amount',  res_detail_ord: 'Merchant Order No',  res_detail_cc: 'Check Code (See Encryption Rules)',  err_title: 'Error Codes',  err_search_ph: 'Search codes...',  th_err_code: 'Error Code',  th_err_reason: 'Reason / Note',  example_title: 'Code Example',  err_MPG01002: 'Timestamp cannot be empty',  err_MPG01005: 'TokenTerm cannot be empty / setting error',  err_MPG01009: 'MerchantID cannot be empty',  err_MPG01011: 'Response specification setting error',  err_MPG01012: 'MerchantOrderNo cannot be empty/format error (Alphanumeric/Underscore only, max 30 chars)',  err_MPG01023: 'Transaction encrypted data cannot be empty',  err_MPG01024: 'Transaction SHA data cannot be empty',  err_MPG01028: 'Order item format error',  err_MPG02002: 'Merchant has no active payment services',  err_MPG02005: 'Validation error (Illegal source)',  err_MPG03001: 'FormPost encryption failed',  err_MPG03002: 'IP Denied',  err_MPG03003: 'IP Transaction Limit Exceeded (N times within M minutes)',  err_MPG03004: 'Merchant status suspended or closed, transaction disabled',  err_MPG03005: 'Return parameter data missing / decryption failed',  err_MPG03006: 'Return parameter data missing / decryption failed',  err_MEM40008: 'Required field cannot be empty',  err_MEM40012: 'Required field transmission error (PostData_ is empty)',  err_MEM40013: 'Incomplete required field data',  err_MEM40014: 'Transmission time error',  err_NOR1001: 'Connection abnormal',  err_TRA10001: 'Failed to retrieve merchant data',  err_TRA10003: 'Amount must be a number',  err_TRA10008: 'Data encryption error (PostData_ decryption failed)',  err_TRA10009: 'MerchantID cannot be empty',  err_TRA10012: 'MerchantID suspended',  err_TRA10015: 'Network connection failed',  err_TRA10018: 'Insufficient data',  err_TRA10021: 'Transaction not found or not a credit card transaction',  err_TRA10047: 'Transaction not in Authorized Success state, cannot void (May be Captured or Failed)',  err_TRA10048: 'Transaction is in Capturing state',  err_TRA10049: 'Transaction is in Refunding state',  err_TRA10050: 'Amount mismatch (Must match authorization amount)',  err_TRA10051: 'Cancel authorization failed',  err_TRA10094: 'Data cancellation failed',  err_TRA10095: 'Transaction past settlement cutoff time, cannot cancel',  err_TRA20001: 'Batch processing by financial institution',  err_TRA20002: 'Transaction data not found',  err_TRA40014: 'TimeStamp field error',  err_1102: 'Merchant not found',  err_1103: 'Order data not found',  err_2100: 'Minimum amount is 1',  err_4101: 'EncryptData_ cannot be empty',  err_4102: 'HashData_ cannot be empty',  err_4103: 'HashData_ verification mismatch',  err_4104: 'Encrypted data error (Check Hash_Key and Hash_IV)',  err_4105: 'TimeStamp is empty',  err_9000: 'Network connection failed'}  },                    
            'KO': {name: '한국어',data: {page_title: 'NewebPay - 신용카드 승인 취소 API 문서',header_mobile_title: '신용카드 승인 취소 API',sidebar_brand: 'NewebPay',sidebar_subtitle: '신용카드 승인 취소 API',sidebar_version_note: '(CreditCard/Cancel)',nav_intro: '소개',nav_setup: '사전 준비',nav_tool: '암호화 도구',nav_group_api: 'API 사양',nav_request: '요청 파라미터',nav_encryption: '암호화 규칙',nav_response: '응답 파라미터',nav_errors: '오류 코드',nav_example: '코드 예제',intro_title: '소개 및 기능',intro_desc: '이 API를 통해 가맹점은 "승인됨" 상태이지만 "매입 전"인 신용카드 거래를 취소(승인 포기)할 수 있습니다. 성공적으로 취소되면 카드 소지자에게 청구되지 않습니다.',intro_funcs_title: '사용 사례',usecase_1_title: '주문 취소',usecase_1_desc: '소비자가 주문 직후 주문을 취소하고 거래가 아직 매입되지 않은 경우, 이 API를 사용하여 즉시 신용 한도를 복구합니다.',usecase_2_title: '예외 처리',usecase_2_desc: '시스템이 주문 이상(예: 재고 부족이나 승인됨)을 감지하면 즉시 이 API를 호출하여 승인을 취소합니다.',setup_title: '사전 준비',setup_card1_title: '키 발급',setup_card1_desc: 'NewebPay 회원 센터에서 상점 ID(MerchantID), <code>Hash Key</code> 및 <code>Hash IV</code>를 발급받으십시오.',setup_card2_title: 'URL 확인',setup_card2_desc: '테스트 환경: https://ccore.newebpay.com/API/CreditCard/Cancel<br>운영 환경: https://core.newebpay.com/API/CreditCard/Cancel',tool_title: '암호화 테스트 도구',tool_intro: '이 도구는 PostData_ 암호화 문자열을 생성하거나 반환된 CheckCode를 검증하는 데 도움을 줍니다.',tool_tab_encrypt: 'AES 암호화 (Request)',tool_tab_decrypt: 'AES 복호화 (Response)',tool_tab_checkcode: 'CheckCode 계산 (Response)',tool_ph_key: '예: AAAAvw3YlqoEk6G4HqRKDAYpHKZWxBBB',tool_ph_iv: '예: AAAACC1FplieBBBB',tool_lbl_qs: '원본 쿼리 문자열',tool_ph_qs: '예: RespondType=JSON&Version=1.0&Amt=30&MerchantOrderNo=ORD_123456&IndexType=1&TimeStamp=1700000000',tool_note_urlencode: '문자열이 http_build_query 또는 urlencode를 통해 처리되었는지 확인하십시오.',tool_btn_encrypt: '암호화하여 PostData_ 생성',tool_lbl_hex: '암호화 결과 (Hex String)',tool_lbl_enc_hex: '암호화된 문자열 (Hex String)',tool_ph_enc_hex: '예: 0ef82edabaf8964d09992d7ec8e575f1...',tool_btn_decrypt: '복호화 실행',tool_lbl_decrypt_res: '복호화 결과 (Raw Data)',tool_btn_cc: 'CheckCode 계산',tool_cc_formula_lbl: '공식 미리보기 (SHA256)',tool_cc_mid: 'MerchantID',tool_cc_amt: 'Amt',tool_cc_ord: 'MerchantOrderNo',tool_cc_trade: 'TradeNo',tool_cc_res_label: 'CheckCode (SHA256)',req_title: '요청 파라미터 (Request)',req_api_info: 'API 정보',req_url_prod: 'URL (운영)',req_url_test: 'URL (테스트)',req_lvl1_title: '1단계 파라미터 (HTML Form Post)',th_param: '파라미터',th_name: '이름',th_required: '필수',th_type: '타입',th_note: '비고',param_mid_name: '상점 ID',param_mid_note: 'NewebPay 상점 ID.',param_post_name: '암호화 데이터',param_post_note: '파라미터를 연결하고 AES-256-CBC를 사용하여 암호화한 다음 Hex 문자열로 변환합니다.',req_lvl2_title: 'PostData_ 내부 파라미터 (암호화 전)',p_res_name: '응답 형식',p_res_note: '고정값: <code class="bg-slate-100 px-1">JSON</code> 또는 <code class="bg-slate-100 px-1">String</code>.',p_ver_name: '버전',p_ver_note: '고정값: <code class="bg-slate-100 px-1">1.0</code>.',p_amt_name: '취소 금액',p_amt_note: '숫자만 허용, 기호 없음. 원 승인 금액과 일치해야 함.',p_idx_name: '인덱스 유형',p_idx_note: '1: 상점 주문 번호 사용 (MerchantOrderNo)<br>2: NewebPay 거래 번호 사용 (TradeNo)',p_ord_name: '상점 주문 번호',p_ord_note: 'IndexType=1인 경우 필수.<br>TradeNo 대신 사용 가능.',p_trade_name: 'NewebPay 거래 번호',p_trade_note: 'IndexType=2인 경우 필수.<br>MerchantOrderNo 대신 사용 가능.',p_process_name: '사용자 정의 프로세스 ID',p_process_note: '이 작업을 위한 상점 정의 ID.',p_ts_name: '타임스탬프',p_ts_note: 'Unix 타임스탬프 (초).<br>PHP 예제: <code>time()</code> 반환값.<br>허용 오차: 120초.',enc_title: '암호화 상세',enc_aes_title: 'AES 암호화 (PostData_)',enc_aes_desc: '민감한 데이터 유출을 방지하기 위해 파라미터는 상점의 Hash Key와 Hash IV를 사용하여 AES 암호화되어야 합니다.',enc_step1_title: '쿼리 문자열 생성',enc_step1_desc: '모든 파라미터를 <code>http_build_query</code> 형식(key=value&key2=value2...)으로 결합합니다.',enc_step2_title: 'AES 암호화',enc_step2_desc: '알고리즘: <span class="font-bold text-red-600">AES-256-CBC</span><br>패딩: <span class="font-bold text-red-600">PKCS7</span><br>Key / IV: 상점 전용 Hash Key와 Hash IV를 사용하십시오.',enc_step3_title: 'Hex 변환',enc_step3_desc: '암호화된 이진 데이터(Raw Data)를 Hex 문자열(소문자)로 변환합니다. 이것이 <code>PostData_</code>입니다.',enc_cc_title: 'CheckCode 생성 규칙 (응답 검증)',enc_cc_desc: 'NewebPay는 데이터 무결성을 보장하기 위해 CheckCode를 반환합니다. 가맹점은 동일한 규칙을 사용하여 로컬에서 계산하여 이를 확인할 수 있습니다.',enc_cc_step1_title: '1단계: 파라미터 연결',enc_cc_step1_desc: '다음 순서로 파라미터를 HashKey 및 HashIV와 연결합니다:',enc_cc_step2_title: '2단계: SHA256 및 대문자 변환',enc_cc_step2_desc: '문자열을 SHA256으로 암호화하고 결과를 <strong>대문자</strong>로 변환합니다.',res_title: '응답 파라미터',res_desc: 'API는 JSON 형식으로 데이터를 반환합니다.',res_status_name: '상태',res_status_note: 'SUCCESS: 승인 취소 성공.<br>TRA20001: 금융 기관의 일괄 처리 필요.',res_msg_name: '메시지',res_msg_note: '거래 상태에 대한 텍스트 설명 (예: 승인 취소 성공).',res_result_name: '결과 데이터',res_result_note: 'MerchantID, TradeNo, Amt, CheckCode 등을 포함하는 배열.',res_detail_title: 'Result 객체 내부 파라미터',res_detail_mid: '상점 ID',res_detail_trade: 'NewebPay 거래 번호',res_detail_amt: '거래 금액',res_detail_ord: '상점 주문 번호',res_detail_cc: '체크 코드 (암호화 규칙 참조)',err_title: '오류 코드',err_search_ph: '코드 검색...',th_err_code: '오류 코드',th_err_reason: '원인 / 비고',example_title: '코드 예제',err_MPG01002: '타임스탬프는 비어 있을 수 없습니다',err_MPG01005: 'TokenTerm은 비어 있을 수 없거나 설정 오류입니다',err_MPG01009: '상점 ID는 비어 있을 수 없습니다',err_MPG01011: '응답 규격 설정 오류',err_MPG01012: '상점 주문 번호는 비어 있을 수 없거나 형식 오류입니다 (영숫자/밑줄만 가능, 최대 30자)',err_MPG01023: '거래 암호화 데이터는 비어 있을 수 없습니다',err_MPG01024: '거래 SHA 데이터는 비어 있을 수 없습니다',err_MPG01028: '주문 항목 형식 오류',err_MPG02002: '활성화된 결제 서비스가 없는 상점입니다',err_MPG02005: '검증 오류 (잘못된 소스)',err_MPG03001: 'FormPost 암호화 실패',err_MPG03002: 'IP 거부됨',err_MPG03003: 'IP 거래 한도 초과 (M분 내 N회)',err_MPG03004: '상점 상태가 정지 또는 폐쇄되어 거래 불가',err_MPG03005: '반환 파라미터 데이터 누락 / 복호화 실패',err_MPG03006: '반환 파라미터 데이터 누락 / 복호화 실패',err_MEM40008: '필수 필드는 비어 있을 수 없습니다',err_MEM40012: '필수 필드 전송 오류 (PostData_가 비어 있음)',err_MEM40013: '필수 필드 데이터 불완전',err_MEM40014: '전송 시간 오류',err_NOR1001: '연결 이상',err_TRA10001: '상점 데이터 조회 실패',err_TRA10003: '금액은 숫자여야 합니다',err_TRA10008: '데이터 암호화 오류 (PostData_ 복호화 실패)',err_TRA10009: '상점 ID는 비어 있을 수 없습니다',err_TRA10012: '상점 ID 정지됨',err_TRA10015: '네트워크 연결 실패',err_TRA10018: '데이터 불충분',err_TRA10021: '거래를 찾을 수 없거나 신용카드 거래가 아님',err_TRA10047: '거래가 승인 성공 상태가 아니므로 취소 불가 (매입됨 또는 실패일 수 있음)',err_TRA10048: '거래가 매입 진행 중 상태임',err_TRA10049: '거래가 환불 진행 중 상태임',err_TRA10050: '금액 불일치 (승인 금액과 일치해야 함)',err_TRA10051: '승인 취소 실패',err_TRA10094: '데이터 취소 실패',err_TRA10095: '정산 마감 시간이 지난 거래는 취소 불가',err_TRA20001: '금융 기관 일괄 처리 중',err_TRA20002: '거래 데이터 찾을 수 없음',err_TRA40014: 'TimeStamp 필드 오류',err_1102: '상점을 찾을 수 없음',err_1103: '주문 데이터를 찾을 수 없음',err_2100: '최소 금액은 1입니다',err_4101: 'EncryptData_는 비어 있을 수 없습니다',err_4102: 'HashData_는 비어 있을 수 없습니다',err_4103: 'HashData_ 검증 불일치',err_4104: '암호화 데이터 오류 (Hash_Key 및 Hash_IV 확인)',err_4105: 'TimeStamp가 비어 있음',err_9000: '네트워크 연결 실패'}  }            
        };

        const errorCodes = [
            'MPG01002', 'MPG01005', 'MPG01009', 'MPG01011', 'MPG01012', 
            'MPG01023', 'MPG01024', 'MPG01028', 'MPG02002', 'MPG02005',
            'MPG03001', 'MPG03002', 'MPG03003', 'MPG03004', 'MPG03005', 'MPG03006',
            'MEM40008', 'MEM40012', 'MEM40013', 'MEM40014', 'NOR1001',
            'TRA10001', 'TRA10003', 'TRA10008', 'TRA10009', 'TRA10012', 'TRA10015',
            'TRA10018', 'TRA10021', 'TRA10047', 'TRA10048', 'TRA10049', 'TRA10050',
            'TRA10051', 'TRA10094', 'TRA10095', 'TRA20001', 'TRA20002', 'TRA40014',
            '1102', '1103', '2100', '4101', '4102', '4103', '4104', '4105', '9000'
        ];

        const codeExamples = {
            php: `<?php
// 1. Setup Merchant Info
$hashKey    = "YourHashKey"; 
$hashIV     = "YourHashIV";  
$merchantID = "MS12345678";  
// API URL
$apiUrl     = "https://ccore.newebpay.com/API/CreditCard/Cancel";

// 2. Prepare Parameters
$params = [
    'RespondType'     => 'JSON',
    'Version'         => '1.0',
    'Amt'             => 30,                 // 需與原交易金額相同
    'MerchantOrderNo' => 'ORD_123456789',    // 商店訂單編號
    'IndexType'       => 1,                  // 1:使用MerchantOrderNo, 2:使用TradeNo
    'TimeStamp'       => time()              // Unix timestamp
];

// 3. Generate Query String
$dataString = http_build_query($params);

// 4. AES-256-CBC Encryption
$encrypted = openssl_encrypt(
    $dataString, 
    'AES-256-CBC', 
    $hashKey, 
    OPENSSL_RAW_DATA, 
    $hashIV
);
$postData = bin2hex($encrypted);
?>

<!-- HTML Form -->
<form method="post" action="<?php echo $apiUrl; ?>">
    <input type="text" name="MerchantID_" value="<?php echo $merchantID; ?>"><br>
    <input type="text" name="PostData_" value="<?php echo $postData; ?>"><br>
    <input type="submit" value="Submit">
</form>`,
            nodejs: `const crypto = require('crypto');
const querystring = require('querystring');
const axios = require('axios');

// 1. Setup Info
const hashKey = 'YourHashKey';
const hashIV  = 'YourHashIV';
const merchantID = 'MS12345678';
const apiUrl = 'https://ccore.newebpay.com/API/CreditCard/Cancel';

// 2. Prepare Params
const params = {
    RespondType: 'JSON',
    Version: '1.0',
    Amt: 30,
    MerchantOrderNo: 'ORD_123456789',
    IndexType: 1,
    TimeStamp: Math.floor(Date.now() / 1000)
};

// 3. Convert to Query String
const dataString = querystring.stringify(params);

// 4. AES Encryption
const cipher = crypto.createCipheriv('aes-256-cbc', hashKey, hashIV);
let encrypted = cipher.update(dataString, 'utf8', 'hex');
encrypted += cipher.final('hex');

// 5. Send POST Request
const formBody = querystring.stringify({
    MerchantID_: merchantID,
    PostData_: encrypted
});

axios.post(apiUrl, formBody, {
    headers: { 'Content-Type': 'application/x-www-form-urlencoded' }
}).then(res => {
    console.log('Response:', res.data);
}).catch(err => {
    console.error('Error:', err);
});`,
            python: `import time
import urllib.parse
import requests
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad
import binascii

# 1. Setup Info
hash_key = b'YourHashKey' # bytes
hash_iv  = b'YourHashIV'  # bytes
merchant_id = 'MS12345678'
api_url = 'https://ccore.newebpay.com/API/CreditCard/Cancel'

# 2. Prepare Params
params = {
    'RespondType': 'JSON',
    'Version': '1.0',
    'Amt': 30,
    'MerchantOrderNo': 'ORD_123456789',
    'IndexType': 1,
    'TimeStamp': int(time.time())
}

# 3. Convert to Query String
data_string = urllib.parse.urlencode(params)

# 4. AES Encryption
cipher = AES.new(hash_key, AES.MODE_CBC, hash_iv)
encrypted_bytes = cipher.encrypt(pad(data_string.encode('utf-8'), AES.block_size))
post_data = binascii.hexlify(encrypted_bytes).decode('utf-8')

# 5. Send POST Request
payload = {
    'MerchantID_': merchant_id,
    'PostData_': post_data
}
response = requests.post(api_url, data=payload)
print(response.text)`,
            csharp: `using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Http;
using System.Security.Cryptography;
using System.Text;
using System.Web;

public class Program
{
    public static async Task Main()
    {
        string hashKey = "YourHashKey";
        string hashIV = "YourHashIV";
        string merchantID = "MS12345678";
        string apiUrl = "https://ccore.newebpay.com/API/CreditCard/Cancel";

        // Prepare Params
        var paramsDict = new Dictionary<string, string>
        {
            { "RespondType", "JSON" },
            { "Version", "1.0" },
            { "Amt", "30" },
            { "MerchantOrderNo", "ORD_123456789" },
            { "IndexType", "1" },
            { "TimeStamp", DateTimeOffset.Now.ToUnixTimeSeconds().ToString() }
        };

        // To Query String
        string dataString = string.Join("&", paramsDict.Select(p => $"{p.Key}={HttpUtility.UrlEncode(p.Value)}"));

        // Encrypt
        string postData = EncryptAES256(dataString, hashKey, hashIV);

        // Send Request
        using (var client = new HttpClient())
        {
            var content = new FormUrlEncodedContent(new[]
            {
                new KeyValuePair<string, string>("MerchantID_", merchantID),
                new KeyValuePair<string, string>("PostData_", postData)
            });

            var response = await client.PostAsync(apiUrl, content);
            string result = await response.Content.ReadAsStringAsync();
            Console.WriteLine(result);
        }
    }

    public static string EncryptAES256(string source, string key, string iv)
    {
        byte[] sourceBytes = Encoding.UTF8.GetBytes(source);
        using (var aes = Aes.Create())
        {
            aes.Mode = CipherMode.CBC;
            aes.Padding = PaddingMode.PKCS7;
            aes.Key = Encoding.UTF8.GetBytes(key);
            aes.IV = Encoding.UTF8.GetBytes(iv);

            using (var encryptor = aes.CreateEncryptor())
            {
                byte[] encryptedBytes = encryptor.TransformFinalBlock(sourceBytes, 0, sourceBytes.Length);
                return BitConverter.ToString(encryptedBytes).Replace("-", "").ToLower();
            }
        }
    }
}`
        };

        // 1. 取得網址參數
        const urlParams = new URLSearchParams(window.location.search);
        const getLang = urlParams.get('lang');

        // 2. 檢查參數是否存在且有效 (是否在 langData 定義中)
        // 如果有效就用參數值，否則預設為 'zh-TW'
        let currentLang = (getLang && langData[getLang]) ? getLang : 'zh-TW';
        let currentCodeTab = 'php';

        function applyTranslations(lang = 'zh-TW') {
            const data = langData[lang]?.data;
            if (!data) return;

            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (data[key]) {
                    el.innerHTML = data[key];
                }
            });

            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (data[key]) {
                    el.setAttribute('placeholder', data[key]);
                }
            });
            
            // Update html lang attribute
            document.documentElement.lang = lang;
        }

        function initLangDropdown() {
            const select = document.getElementById('lang-select');
            const languages = Object.keys(langData);
            if (languages.length === 0) return;

            select.innerHTML = '';
            languages.forEach(langKey => {
                const option = document.createElement('option');
                option.value = langKey;
                option.textContent = langData[langKey].name;
                if(langKey === currentLang) option.selected = true;
                select.appendChild(option);
            });
        }

        function changeLang(targetLang) {
            currentLang = targetLang;
            applyTranslations(targetLang);
            renderErrorTable(); // Re-render error table with new lang
            loadCode(currentCodeTab); // Re-load code with new lang comments
        }

        function renderErrorTable() {
            const tbody = document.querySelector('#errorTable tbody');
            if (!tbody) return;
            
            const data = langData[currentLang].data;

            tbody.innerHTML = '';
            const html = errorCodes.map(code => {
                const i18nKey = `err_${code}`;
                const text = data[i18nKey] || '';
                return `<tr>
                    <td class="px-6 py-2 font-bold text-red-600">${code}</td>
                    <td class="px-6 py-2" data-i18n="${i18nKey}">${text}</td>
                </tr>`;
            }).join('');
            tbody.innerHTML = html;
        }

        window.onload = function() {
            initLangDropdown();
            applyTranslations(currentLang);
            renderErrorTable();
            loadCode(currentCodeTab);
        };

        function switchTab(lang, event) {
            document.querySelectorAll('#example .tab-btn').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');
            currentCodeTab = lang;
            loadCode(lang);
        }

        function loadCode(lang) {
            const display = document.getElementById('code-display');
            
            // Ensure lang has a value, default to 'php'
            if (!lang) lang = 'php';

            // Directly access global codeExamples
            display.value = codeExamples[lang] || "// Code example not available.";
        }

        function switchToolTab(tabId) {
            document.querySelectorAll('.tool-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.tool-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tool-tab-btn').forEach(el => {
                el.classList.remove('active', 'border-purple-600', 'text-purple-600');
                el.classList.add('border-transparent', 'text-slate-500');
            });

            const targetContent = document.getElementById(tabId);
            targetContent.classList.remove('hidden');
            targetContent.classList.add('active');

            const btn = event.currentTarget;
            btn.classList.remove('border-transparent', 'text-slate-500');
            btn.classList.add('active', 'border-purple-600', 'text-purple-600');
        }

        const menuBtn = document.getElementById('menu-btn');
        const sidebar = document.getElementById('sidebar');
        let isMenuOpen = false;

        menuBtn.addEventListener('click', () => {
            isMenuOpen = !isMenuOpen;
            sidebar.classList.toggle('-translate-x-full');
        });

        const searchInput = document.getElementById('errorSearch');
        searchInput.addEventListener('keyup', (e) => {
            const term = e.target.value.toLowerCase();
            const tableRows = document.querySelectorAll('#errorTable tbody tr');
            tableRows.forEach(row => {
                const code = row.children[0].textContent.toLowerCase();
                const msg = row.children[1].textContent.toLowerCase();
                if (code.includes(term) || msg.includes(term)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });

        // AES Tools
        function getKeys() {
            const key = document.getElementById('toolKey').value.trim();
            const iv = document.getElementById('toolIv').value.trim();
            if (!key || !iv) {
                // Simple alert fallback translation
                const msg = currentLang === 'zh-TW' ? '請輸入 Hash Key 與 Hash IV' : 'Please enter Hash Key and Hash IV';
                alert(msg);
                return null;
            }
            return { key, iv };
        }

        function runEncrypt() {
            const keys = getKeys();
            if (!keys) return;
            const data = document.getElementById('encryptInput').value.trim();
            if (!data) {
                const msg = currentLang === 'zh-TW' ? '請輸入原始字串' : 'Please enter original string';
                return alert(msg);
            }

            try {
                const keyHex = CryptoJS.enc.Utf8.parse(keys.key);
                const ivHex = CryptoJS.enc.Utf8.parse(keys.iv);

                const encrypted = CryptoJS.AES.encrypt(data, keyHex, {
                    iv: ivHex,
                    mode: CryptoJS.mode.CBC,
                    padding: CryptoJS.pad.Pkcs7
                });

                document.getElementById('encryptOutput').value = encrypted.ciphertext.toString(CryptoJS.enc.Hex);
            } catch (e) {
                console.error(e);
                const msg = currentLang === 'zh-TW' ? '加密失敗: ' : 'Encryption failed: ';
                alert(msg + e.message);
            }
        }

        function runDecrypt() {
            const keys = getKeys();
            if (!keys) return;
            const hexStr = document.getElementById('decryptInput').value.trim();
            if (!hexStr) {
                 const msg = currentLang === 'zh-TW' ? '請輸入加密後的 Hex 字串' : 'Please enter Encrypted Hex String';
                 return alert(msg);
            }

            try {
                const keyHex = CryptoJS.enc.Utf8.parse(keys.key);
                const ivHex = CryptoJS.enc.Utf8.parse(keys.iv);
                
                const encryptedHex = CryptoJS.enc.Hex.parse(hexStr);
                const encryptedBase64 = CryptoJS.enc.Base64.stringify(encryptedHex);

                const decrypted = CryptoJS.AES.decrypt(encryptedBase64, keyHex, {
                    iv: ivHex,
                    mode: CryptoJS.mode.CBC,
                    padding: CryptoJS.pad.Pkcs7
                });

                document.getElementById('decryptOutput').value = decrypted.toString(CryptoJS.enc.Utf8);
            } catch (e) {
                console.error(e);
                const msg = currentLang === 'zh-TW' ? '解密失敗，請檢查 Key/IV 或加密字串格式' : 'Decryption failed. Check Key/IV or format.';
                alert(msg);
            }
        }
        
        // CheckCode Tool
        function runCheckCode() {
            const keys = getKeys();
            if (!keys) return;
            
            const mid = document.getElementById('ccMid').value.trim();
            const amt = document.getElementById('ccAmt').value.trim();
            const ord = document.getElementById('ccOrd').value.trim();
            const trade = document.getElementById('ccTrade').value.trim();
            
            if(!mid || !amt || !ord || !trade) {
                 const msg = currentLang === 'zh-TW' ? '請完整填寫所有欄位' : 'Please fill all fields.';
                 return alert(msg);
            }
            
            // Formula: HashIV={iv}&Amt={amt}&MerchantID={mid}&MerchantOrderNo={ord}&TradeNo={trade}&HashKey={key}
            const str = `HashIV=${keys.iv}&Amt=${amt}&MerchantID=${mid}&MerchantOrderNo=${ord}&TradeNo=${trade}&HashKey=${keys.key}`;
            
            // Preview
            document.getElementById('ccFormulaPreview').innerText = str;
            
            // Calculate
            const hash = CryptoJS.SHA256(str).toString(CryptoJS.enc.Hex).toUpperCase();
            document.getElementById('ccOutput').value = hash;
        }

        // Scroll Spy
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('section');
            const navLinks = document.querySelectorAll('.nav-link');
            let current = '';

            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (scrollY >= (sectionTop - 200)) {
                    current = section.getAttribute('id');
                }
            });

            if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 50) {
                 if (sections.length > 0) {
                     current = sections[sections.length - 1].getAttribute('id');
                 }
            }

            navLinks.forEach(link => {
                link.classList.remove('sidebar-active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('sidebar-active');
                }
            });
        });
    </script>
</body>
</html>